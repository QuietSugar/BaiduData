import com.maybe.pojo.BusLine;
import com.maybe.util.FinalStatic;
import com.maybe.util.WriteListToExcelFile;
import org.codehaus.jackson.map.ObjectMapper;

import java.io.IOException;
import java.util.HashSet;

/**
 * Created by Maybe on 2016/7/14
 * Maybe has infinite possibilities
 */
public class Test {
    @org.junit.Test
    public void run() {
        String lineBusValueString = "{\"line_name\":\"里二泗总站-地铁九棵树站通勤班车(地铁九棵树站-里二泗总站)\",\"line\":[{\"lng\":116.663122,\"lat\":39.896888},{\"lng\":116.663872,\"lat\":39.89667},{\"lng\":116.664212,\"lat\":39.896572},{\"lng\":116.664252,\"lat\":39.89656},{\"lng\":116.664494,\"lat\":39.896489},{\"lng\":116.665175,\"lat\":39.896292},{\"lng\":116.665509,\"lat\":39.896195},{\"lng\":116.665515,\"lat\":39.896193},{\"lng\":116.666407,\"lat\":39.895934},{\"lng\":116.667808,\"lat\":39.895527},{\"lng\":116.668492,\"lat\":39.895256},{\"lng\":116.668492,\"lat\":39.895255},{\"lng\":116.668702,\"lat\":39.89516},{\"lng\":116.668904,\"lat\":39.895069},{\"lng\":116.668904,\"lat\":39.895069},{\"lng\":116.669035,\"lat\":39.894976},{\"lng\":116.669407,\"lat\":39.89471},{\"lng\":116.670576,\"lat\":39.893741},{\"lng\":116.671555,\"lat\":39.892929},{\"lng\":116.671705,\"lat\":39.892805},{\"lng\":116.672005,\"lat\":39.892556},{\"lng\":116.672005,\"lat\":39.892556},{\"lng\":116.672706,\"lat\":39.891973},{\"lng\":116.673782,\"lat\":39.891079},{\"lng\":116.673904,\"lat\":39.890977},{\"lng\":116.67414,\"lat\":39.890781},{\"lng\":116.674594,\"lat\":39.890404},{\"lng\":116.675439,\"lat\":39.889701},{\"lng\":116.675448,\"lat\":39.889694},{\"lng\":116.676988,\"lat\":39.888457},{\"lng\":116.677705,\"lat\":39.887865},{\"lng\":116.677893,\"lat\":39.88771},{\"lng\":116.678149,\"lat\":39.887498},{\"lng\":116.678315,\"lat\":39.887361},{\"lng\":116.679526,\"lat\":39.886362},{\"lng\":116.67987,\"lat\":39.886077},{\"lng\":116.680387,\"lat\":39.88565},{\"lng\":116.681518,\"lat\":39.884716},{\"lng\":116.681519,\"lat\":39.884716},{\"lng\":116.681949,\"lat\":39.884367},{\"lng\":116.682055,\"lat\":39.884282},{\"lng\":116.683047,\"lat\":39.883479},{\"lng\":116.683349,\"lat\":39.883234},{\"lng\":116.686211,\"lat\":39.880853},{\"lng\":116.686398,\"lat\":39.880697},{\"lng\":116.686659,\"lat\":39.88048},{\"lng\":116.68666,\"lat\":39.880479},{\"lng\":116.687459,\"lat\":39.879895},{\"lng\":116.687483,\"lat\":39.879877},{\"lng\":116.687545,\"lat\":39.879838},{\"lng\":116.688056,\"lat\":39.879519},{\"lng\":116.689403,\"lat\":39.878839},{\"lng\":116.691041,\"lat\":39.878337},{\"lng\":116.691543,\"lat\":39.87821},{\"lng\":116.693692,\"lat\":39.877664},{\"lng\":116.695338,\"lat\":39.877216},{\"lng\":116.695343,\"lat\":39.877215},{\"lng\":116.695787,\"lat\":39.877096},{\"lng\":116.696573,\"lat\":39.876886},{\"lng\":116.697595,\"lat\":39.876614},{\"lng\":116.698016,\"lat\":39.876501},{\"lng\":116.698371,\"lat\":39.876407},{\"lng\":116.698823,\"lat\":39.876286},{\"lng\":116.699856,\"lat\":39.87601},{\"lng\":116.701695,\"lat\":39.875519},{\"lng\":116.701775,\"lat\":39.875498},{\"lng\":116.701775,\"lat\":39.875498},{\"lng\":116.703478,\"lat\":39.875013},{\"lng\":116.704898,\"lat\":39.874608},{\"lng\":116.705178,\"lat\":39.874528},{\"lng\":116.705178,\"lat\":39.874527},{\"lng\":116.705504,\"lat\":39.874438},{\"lng\":116.705829,\"lat\":39.874348},{\"lng\":116.706185,\"lat\":39.87425},{\"lng\":116.706638,\"lat\":39.874126},{\"lng\":116.707715,\"lat\":39.87383},{\"lng\":116.708158,\"lat\":39.873708},{\"lng\":116.708158,\"lat\":39.873708},{\"lng\":116.709232,\"lat\":39.873428},{\"lng\":116.71071,\"lat\":39.873042},{\"lng\":116.713089,\"lat\":39.872421},{\"lng\":116.71319,\"lat\":39.872395},{\"lng\":116.713331,\"lat\":39.872358},{\"lng\":116.71335,\"lat\":39.872354},{\"lng\":116.714689,\"lat\":39.87207},{\"lng\":116.714747,\"lat\":39.872058},{\"lng\":116.714748,\"lat\":39.872058},{\"lng\":116.715559,\"lat\":39.871853},{\"lng\":116.715974,\"lat\":39.871748},{\"lng\":116.715974,\"lat\":39.871747},{\"lng\":116.715976,\"lat\":39.871747},{\"lng\":116.716572,\"lat\":39.871602},{\"lng\":116.717307,\"lat\":39.871423},{\"lng\":116.717661,\"lat\":39.871338},{\"lng\":116.717758,\"lat\":39.871314},{\"lng\":116.717758,\"lat\":39.871314},{\"lng\":116.717868,\"lat\":39.871145},{\"lng\":116.717868,\"lat\":39.871145},{\"lng\":116.718077,\"lat\":39.871097},{\"lng\":116.718117,\"lat\":39.871088},{\"lng\":116.718386,\"lat\":39.870981},{\"lng\":116.718947,\"lat\":39.870701},{\"lng\":116.719502,\"lat\":39.870423},{\"lng\":116.71995,\"lat\":39.870249},{\"lng\":116.725215,\"lat\":39.86893},{\"lng\":116.72616,\"lat\":39.868755},{\"lng\":116.727642,\"lat\":39.868619},{\"lng\":116.727642,\"lat\":39.868618},{\"lng\":116.727642,\"lat\":39.868303},{\"lng\":116.727642,\"lat\":39.868299},{\"lng\":116.727641,\"lat\":39.868298},{\"lng\":116.72768,\"lat\":39.866599},{\"lng\":116.727725,\"lat\":39.865958},{\"lng\":116.727781,\"lat\":39.865158},{\"lng\":116.727828,\"lat\":39.864481},{\"lng\":116.727829,\"lat\":39.864481},{\"lng\":116.727858,\"lat\":39.864059},{\"lng\":116.727888,\"lat\":39.863619},{\"lng\":116.727911,\"lat\":39.86329},{\"lng\":116.728006,\"lat\":39.861906},{\"lng\":116.728006,\"lat\":39.861903},{\"lng\":116.728019,\"lat\":39.861711},{\"lng\":116.728048,\"lat\":39.861301},{\"lng\":116.728068,\"lat\":39.861002},{\"lng\":116.728127,\"lat\":39.860153},{\"lng\":116.728194,\"lat\":39.859175},{\"lng\":116.728217,\"lat\":39.858844},{\"lng\":116.728222,\"lat\":39.858781},{\"lng\":116.728222,\"lat\":39.858776},{\"lng\":116.728246,\"lat\":39.858533},{\"lng\":116.728259,\"lat\":39.858403},{\"lng\":116.728492,\"lat\":39.85606},{\"lng\":116.728488,\"lat\":39.856102},{\"lng\":116.728508,\"lat\":39.8559},{\"lng\":116.729069,\"lat\":39.856003},{\"lng\":116.729533,\"lat\":39.856088},{\"lng\":116.730595,\"lat\":39.85634},{\"lng\":116.731729,\"lat\":39.856609},{\"lng\":116.73496,\"lat\":39.857375},{\"lng\":116.735825,\"lat\":39.857661},{\"lng\":116.735825,\"lat\":39.857661},{\"lng\":116.739552,\"lat\":39.85784},{\"lng\":116.739552,\"lat\":39.85784},{\"lng\":116.743627,\"lat\":39.857832},{\"lng\":116.743627,\"lat\":39.857832},{\"lng\":116.743755,\"lat\":39.856704},{\"lng\":116.743863,\"lat\":39.856152},{\"lng\":116.743864,\"lat\":39.856146},{\"lng\":116.744004,\"lat\":39.855417},{\"lng\":116.744051,\"lat\":39.855168},{\"lng\":116.744399,\"lat\":39.853354},{\"lng\":116.744399,\"lat\":39.853354},{\"lng\":116.744642,\"lat\":39.852308},{\"lng\":116.744723,\"lat\":39.85196},{\"lng\":116.744784,\"lat\":39.8517},{\"lng\":116.744873,\"lat\":39.851316},{\"lng\":116.744874,\"lat\":39.851311},{\"lng\":116.744993,\"lat\":39.850763},{\"lng\":116.744993,\"lat\":39.850763},{\"lng\":116.74506,\"lat\":39.849674},{\"lng\":116.74512,\"lat\":39.848695},{\"lng\":116.74512,\"lat\":39.848695},{\"lng\":116.744813,\"lat\":39.84838},{\"lng\":116.744812,\"lat\":39.848379},{\"lng\":116.744382,\"lat\":39.847933},{\"lng\":116.744264,\"lat\":39.84781},{\"lng\":116.743865,\"lat\":39.846113},{\"lng\":116.743865,\"lat\":39.846113},{\"lng\":116.744945,\"lat\":39.84368},{\"lng\":116.744976,\"lat\":39.843611},{\"lng\":116.745612,\"lat\":39.842971},{\"lng\":116.746288,\"lat\":39.842682},{\"lng\":116.748138,\"lat\":39.842621},{\"lng\":116.749033,\"lat\":39.842754},{\"lng\":116.750557,\"lat\":39.843196},{\"lng\":116.750557,\"lat\":39.843195},{\"lng\":116.750446,\"lat\":39.841774},{\"lng\":116.750446,\"lat\":39.841774},{\"lng\":116.750446,\"lat\":39.841773},{\"lng\":116.750378,\"lat\":39.840752},{\"lng\":116.750359,\"lat\":39.840462},{\"lng\":116.750355,\"lat\":39.840402},{\"lng\":116.750355,\"lat\":39.840402},{\"lng\":116.752097,\"lat\":39.840402},{\"lng\":116.756391,\"lat\":39.8404},{\"lng\":116.757408,\"lat\":39.8404},{\"lng\":116.759912,\"lat\":39.840399},{\"lng\":116.759912,\"lat\":39.840398},{\"lng\":116.759915,\"lat\":39.840398},{\"lng\":116.760201,\"lat\":39.840398},{\"lng\":116.763176,\"lat\":39.840393},{\"lng\":116.765075,\"lat\":39.84039},{\"lng\":116.765195,\"lat\":39.840389},{\"lng\":116.765995,\"lat\":39.840388},{\"lng\":116.765995,\"lat\":39.840388},{\"lng\":116.765995,\"lat\":39.840379},{\"lng\":116.765995,\"lat\":39.840378}],\"company\":\"北京八方达客运有限责任公司通州分公司\",\"stations\":[{\"name\":\"地铁九棵树站\",\"position\":{\"lng\":116.663127,\"lat\":39.896886},\"_uid\":\"e58e4aed26c488d83010af48\"},{\"name\":\"九棵树\",\"position\":{\"lng\":116.668494,\"lat\":39.895256},\"_uid\":\"8e2f397c5ae64760eddfcab1\"},{\"name\":\"杨家洼\",\"position\":{\"lng\":116.672002,\"lat\":39.892554},\"_uid\":\"0d749274ad558442f82d610e\"},{\"name\":\"地铁梨园站\",\"position\":{\"lng\":116.675461,\"lat\":39.889717},\"_uid\":\"41e8fb8e2073cd88cb213d69\"},{\"name\":\"通州小街桥东\",\"position\":{\"lng\":116.681511,\"lat\":39.88471},\"_uid\":\"5791d44c81275cfbb5f42f34\"},{\"name\":\"地铁临河里站\",\"position\":{\"lng\":116.686645,\"lat\":39.880467},\"_uid\":\"9d45cf54c36933eafb2d61cc\"},{\"name\":\"地铁土桥站\",\"position\":{\"lng\":116.695345,\"lat\":39.877218},\"_uid\":\"ae6e5f04b12cecda2d47337f\"},{\"name\":\"土桥欣村\",\"position\":{\"lng\":116.70519,\"lat\":39.874539},\"_uid\":\"b46533e219cf1e25f82d6149\"},{\"name\":\"土桥新桥东\",\"position\":{\"lng\":116.71597,\"lat\":39.871732},\"_uid\":\"bfad9dd0d994c0d3a11de9c5\"},{\"name\":\"张凤路北口\",\"position\":{\"lng\":116.727643,\"lat\":39.868303},\"_uid\":\"122a7cdbb4d1b4586d20b9c2\"},{\"name\":\"张家湾镇政府\",\"position\":{\"lng\":116.727846,\"lat\":39.864485},\"_uid\":\"83493ab6f9a05ce39e95de75\"},{\"name\":\"北许场新村\",\"position\":{\"lng\":116.727998,\"lat\":39.861906},\"_uid\":\"8e28ad853a200e0fc27da293\"},{\"name\":\"张家湾中心小学\",\"position\":{\"lng\":116.728205,\"lat\":39.85878},\"_uid\":\"dfc50caa5fc0146d2e47334c\"},{\"name\":\"西定福庄北口\",\"position\":{\"lng\":116.743876,\"lat\":39.856153},\"_uid\":\"4d1019f91776a0fd17c8f6f3\"},{\"name\":\"环湖小区北口\",\"position\":{\"lng\":116.744873,\"lat\":39.851316},\"_uid\":\"571d11d3033e82027069d388\"},{\"name\":\"环湖小区\",\"position\":{\"lng\":116.744823,\"lat\":39.848374},\"_uid\":\"529f3612592f486a72455bd0\"},{\"name\":\"西定福庄南口\",\"position\":{\"lng\":116.750451,\"lat\":39.841774},\"_uid\":\"6a1c2b59549c9705cd04efa7\"},{\"name\":\"烧酒巷\",\"position\":{\"lng\":116.759915,\"lat\":39.840386},\"_uid\":\"74d4bdbaabbd01aa902ca355\"},{\"name\":\"里二泗总站\",\"position\":{\"lng\":116.765997,\"lat\":39.840379},\"_uid\":\"74a06a54027c2f460582c249\"}],\"startTime\":\"07:00\",\"endTime\":\"09:00\"}";
        System.out.println("-------" + lineBusValueString);
        ObjectMapper mapper = new ObjectMapper();
        BusLine busLine = null;
        try {
            busLine = mapper.readValue(lineBusValueString, BusLine.class);
        } catch (IOException e) {
            e.printStackTrace();
        }

        //站点信息
        String str = busLine.getLine_name();
        int int0 = str.lastIndexOf("(");
        int int1 = str.lastIndexOf("-");
        int int2 = str.lastIndexOf(")");
        String lineName = str.substring(0, int0);
        String startStation = str.substring(int0 + 1, int1);
        String endStation = str.substring(int1 + 1, int2);

        String stationgStr0 = lineName + "-" + startStation + "-" + endStation;

        //判断线路名称是否符合
        FinalStatic finalStatic = new FinalStatic();
        HashSet<String> hashSet = (HashSet<String>) (finalStatic.getSet());
        String busName = busLine.getLine_name();
        String fileName = "C:\\Users\\Administrator\\Desktop\\line\\" + busName + ".xlsx";
        try {
            WriteListToExcelFile.writeStationToFile(fileName, busLine);
        } catch (Exception e) {
            System.out.println("失败了");
            e.printStackTrace();
        }

    }
}
